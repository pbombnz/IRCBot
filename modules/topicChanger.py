#!/usr/bin/python
# -*- coding: utf-8 -*-

IRC_TOPIC_TEMPLATES = ['4,9Ã‚Â°~`~*Ã‚Â¤Ã‚Â§Ã†â€™12 TOPIC_HERE 4Ã†â€™Ã‚Â§Ã‚Â¤*~`~Ã‚Â°',
                       '9,1ÃƒÂ¸Ã‚Â¤Ã‚Â°`Ã‚Â°Ã‚Â¤ÃƒÂ¸  TOPIC_HERE 9,1ÃƒÂ¸Ã‚Â¤Ã‚Â°`Ã‚Â°Ã‚Â¤ÃƒÂ¸ ',
                       '4Ã‚Â©Ã‚ÂºÃ‚Â°Ã‚Â¨Ã‚Â¨Ã‚Â°Ã‚ÂºÃ‚Â©Ã‚Â©Ã‚ÂºÃ‚Â°Ã‚Â¨Ã‚Â¨Ã‚Â°Ã‚ÂºÃ‚Â©12 TOPIC_HERE 4Ã‚Â©Ã‚ÂºÃ‚Â°Ã‚Â¨Ã‚Â¨Ã‚Â°Ã‚ÂºÃ‚Â©Ã‚Â©Ã‚ÂºÃ‚Â°Ã‚Â¨Ã‚Â¨Ã‚Â°Ã‚ÂºÃ‚Â©',
                       '12(Ã‚Â¯`Ã‚Â·._(Ã‚Â¯`Ã‚Â·._(Ã‚Â¯`Ã‚Â·._(4 TOPIC_HERE 12)_.Ã‚Â·Ã‚Â´Ã‚Â¯)_.Ã‚Â·Ã‚Â´Ã‚Â¯)_.Ã‚Â·Ã‚Â´Ã‚Â¯)',
                       '4 (Ã‚Â¯`Ã‚Â·.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â´Ã‚Â¯`Ã‚Â·.Ã‚Â¸Ã‚Â¸.->12 TOPIC_HERE 8<-.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â´Ã‚Â¯`Ã‚Â·.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â´Ã‚Â¯)',
                       '4Ã‚Â¯Ã‚Â°Ã‚Â·.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â°Ã‚Â¯Ã‚Â°Ã‚Â·.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â°Ã‚Â¯Ã‚Â°Ã‚Â·.Ã‚Â¸Ã‚Â¸.->12 TOPIC_HERE 4<-.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â°Ã‚Â¯Ã‚Â°Ã‚Â·.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â°Ã‚Â¯Ã‚Â°Ã‚Â·.Ã‚Â¸Ã‚Â¸.Ã‚Â·Ã‚Â°Ã‚Â¯',
                       '8,12.,-*-,._.,-*"^"~*-,._.,-*~>4 TOPIC_HERE 8<~*-,._.,-*~"^"~*-,._.,-*-,.',
                       '11|!Ã‚Â¤*"~``~"*Ã‚Â¤!||!Ã‚Â¤*"~``~"*Ã‚Â¤!|13 TOPIC_HERE 11|!Ã‚Â¤*"~``~"*Ã‚Â¤!||!Ã‚Â¤*"~``~"*Ã‚Â¤!|',
                       '4.8Ã‚Â§Ã‚Â¤*~`~*Ã‚Â¤Ã‚Â§|Ã‚Â§Ã‚Â¤*~`~*Ã‚Â¤Ã‚Â§|Ã‚Â§Ã‚Â¤*~ -=Ã‚?=-12 TOPIC_HERE 4-=Ã‚?=- ~*Ã‚Â¤Ã‚Â§|Ã‚Â§Ã‚Â¤*~`~*Ã‚Â¤Ã‚Â§|Ã‚Â§Ã‚Â¤*~`~*Ã‚Â¤Ã‚Â§',
                       '12,1,ÃƒÂ¸Ã‚Â¤Ã‚Â°9`11Ã‚Â°Ã‚Â¤ÃƒÂ¸,Ã‚Â¸ 12Ã‚Â¸,ÃƒÂ¸Ã‚Â¤Ã‚Â°9`11Ã‚Â°Ã‚Â¤ÃƒÂ¸,Ã‚Â¸ TOPIC_HERE 12,1,ÃƒÂ¸Ã‚Â¤Ã‚Â°9`11Ã‚Â°Ã‚Â¤ÃƒÂ¸,Ã‚Â¸ 12Ã‚Â¸,ÃƒÂ¸Ã‚Â¤Ã‚Â°9`11Ã‚Â°Ã‚Â¤ÃƒÂ¸,Ã‚Â¸',
                       '9,1.Ã‚Â»Ã‚Âº}8Ã‚Â®9{Ã‚ÂºÃ‚Â«Ã‚Âº}8Ã‚Â®9{Ã‚ÂºÃ‚Â«. TOPIC_HERE 9,1.Ã‚Â»Ã‚Âº}8Ã‚Â®9{Ã‚ÂºÃ‚Â«Ã‚Â»Ã‚Âº}8Ã‚Â®9{Ã‚ÂºÃ‚Â«.',
                       '3,1{ÃƒÂ¦{13Ã‚Â©3{ÃƒÂ¦{13Ã‚Â©3{ÃƒÂ¦{13Ã‚Â©3{ÃƒÂ¦{13Ã‚Â© 12{  TOPIC_HERE 12,1} 13Ã‚Â©3}ÃƒÂ¦}13Ã‚Â©3}ÃƒÂ¦}13Ã‚Â©3}ÃƒÂ¦}13Ã‚Â©3}ÃƒÂ¦}',
                       '0,19Ã‚Â¿13?7Ã‚Â¿11?9Ã‚Â¿13?7Ã‚Â¿109Ã‚Â¿13?7Ã‚Â¿11?9Ã‚Â¿13?7Ã‚Â¿10 TOPIC_HERE 0,19Ã‚Â¿13?7Ã‚Â¿11?9Ã‚Â¿13?7Ã‚Â¿109Ã‚Â¿13?7Ã‚Â¿11?9Ã‚Â¿13?7Ã‚Â¿10',
                       '2!3Ã‚Â¡4!6Ã‚Â¡7!8Ã‚Â¡9!10Ã‚Â¡11!12Ã‚Â¡13!14Ã‚Â¡2!3Ã‚Â¡46!7Ã‚Â¡8!9Ã‚Â¡10!11Ã‚Â¡ 4 TOPIC_HERE 2!3Ã‚Â¡4!6Ã‚Â¡7!8Ã‚Â¡9!10Ã‚Â¡11!12Ã‚Â¡13!14Ã‚Â¡2!3Ã‚Â¡46!7Ã‚Â¡8!9Ã‚Â¡10!11Ã‚Â¡ 4',
                       '12Ã‚Â»Ã‚Â»-4(Ã‚Â¯`vÃ‚Â´Ã‚Â¯)12--Ã‚Â»6 TOPIC_HERE 12Ã‚Â»Ã‚Â»-4(Ã‚Â¯`vÃ‚Â´Ã‚Â¯)12--Ã‚Â»6',
                       '4,2Ã‚Â«2,4Ã‚Â»13,2Ã‚Â«2,13Ã‚Â»15,2Ã‚Â«2,15Ã‚Â»8,2Ã‚Â«2,8Ã‚Â»11,2Ã‚Â«2,11Ã‚Â»9,2Ã‚Â«2,9Ã‚Â»0,1 TOPIC_HERE 2,9Ã‚Â«9,2Ã‚Â»2,11Ã‚Â«11,2Ã‚Â»2,8Ã‚Â«8,2Ã‚Â»2,15Ã‚Â«15,2Ã‚Â»2,13Ã‚Â«13,2Ã‚Â»2,4Ã‚Â«4,2Ã‚Â»',
                       '8,0|0,8|7,8|8,7|4,7|7,4|5,4|4,5|1,5|5,1| 9,1 TOPIC_HERE 5,1 |1,5|4,5|5,4|7,4|4,7|8,7|7,8|',
                       '3,1\1,3\9,3\3,9\0,9\9,0\0,0-15,0\0,15\14,15\15,14\1,14\14,1\1,1-0,1 TOPIC_HERE 1,1-14,1/1,14/15,14/14,15/0,15/15,0/0,0-9,0/0,9/3,9/9,3/1,3/3,1/0,0',
                       '8,1Ã‚Â®8,14Ã‚Â®8,15Ã‚Â®8,0Ã‚Â®8,15Ã‚Â®8,14Ã‚Â®8,1Ã‚Â® 0 TOPIC_HERE 8,1Ã‚Â®8,14Ã‚Â®8,15Ã‚Â®8,0Ã‚Â®8,15Ã‚Â®8,14Ã‚Â®8,1Ã‚Â®',
                       '8,6Ã‚Â¯0`Ã‚Â°Ã‚Â²Ã‚Âº4Ã‚Â¤8ÃƒÂ¦=Ã‚Â¬0Ã‚Â«.,Ã‚Â¸8_0,6 TOPIC_HERE 8,6_Ã‚Â¸,.0Ã‚Â»Ã‚Â¬=8ÃƒÂ¦4Ã‚Â¤0Ã‚ÂºÃ‚Â²Ã‚Â°`8Ã‚Â¯',
                       '2{3{4{5{6{7{8{9{10{11{12{13{14{15{2{3{4{5{6{7{8{9{10{11{12{13{14{15{1 TOPIC_HERE 15}14}13}12}11}10}9}8}7}6}5}4}3}2}15}14}13}12}11}10}9}8}7}6}5}4}3}2}',
                       '1,11,21,31,41,51,61,71,81,91,108,1  TOPIC_HERE  1,101,91,81,71,61,51,41,31,21',
                       '1215,8%8,8|4,8%8,4%4,4|5,4%4,5%5,5|1,5%5,1%1-- 16 TOPIC_HERE 1--5,1%1,5%5,5|4,5%5,4%4,4|8,4%4,8%8,8|15,8%1',
                       '9`%16,9%,  3,9`%9,3%,  1,3`%3,1%,16,1 TOPIC_HERE 3,1`%1,3%,  9,3`%3,9%,  16,9`%9,16%, 1',
                       '0,15%,14`%15,14%,1`%14,1%,15,1 TOPIC_HERE  14,1`%1,14%,15`%14,15%,0`%3,0',
                       '15,0,%0,15%`13,15,%15,13%`6,13,%13,6%`5,6,% 8 TOPIC_HERE 5,6%,13,6`%6,13%,15,13`%13,15%,0,15`%15,0%,',
                       '8,0 ,%0,8%`7,8,%8,7%`4,7,%7,4%`8,4 TOPIC_HERE 7,4`%4,7%,8,7`%7,8%,0,8`%8,0%, ',
                       '13,0<0,13>6,13<13,6>2,6<6,2>1,2<2,1>0,1 TOPIC_HERE 2,1<1,2>6,2<2,6>13,6<6,13>0,13<13,0>']


def on_channel_pm(irc, user_mask, user, channel, message):
    command = message.split()

    if command[0].lower() == '!settopic':
        if irc.nick_name in irc.get_channel_info()[channel]["Voice"] \
        or irc.nick_name in irc.get_channel_info()[channel]["Regular"]:
            irc.send_private_message(channel, '5ERROR: I do not have privilages to change the topic.')
            return

        if user in irc.get_channel_info()[channel]["Voice"] or user in irc.get_channel_info()[channel]["Regular"]:
            irc.send_private_message(channel, '5ERROR: You do not have access to this command.')
            return

        if len(command) < 3:
            irc.send_private_message(channel,'USAGE: !settopic (Topic Style [1- ' + str(len(IRC_TOPIC_TEMPLATES)) + ']) (Topic)')
            return

        command = message.split(' ', 2)

        if len(command[1]) < 1 or len(command[2]) < 1:
            irc.send_private_message(channel,'USAGE: !settopic (Topic Style [1- ' + str(len(IRC_TOPIC_TEMPLATES)) + ']) (Topic)')
            return

        if not command[1].isdigit():
            irc.send_private_message(channel,'USAGE: !settopic (Topic Style [1- ' + str(len(IRC_TOPIC_TEMPLATES)) + ']) (Topic)')
            return

        command[1] = int(command[1])
        if command[1] < 1 or command[1] > len(IRC_TOPIC_TEMPLATES):
             irc.send_private_message(channel, 'USAGE: !settopic (Topic Style [1- ' + str(len(IRC_TOPIC_TEMPLATES)) + ']) (Topic)')
             return

        command[1] = command[1] - 1
        irc.sendRawMessage('TOPIC ' + channel + ' :' + str(IRC_TOPIC_TEMPLATES[command[1]].replace('TOPIC_HERE', str(command[2]))))

    if command[0].lower() == '!topicstyles':
        is_channel_admin = False
        for op in irc.get_channel_info()[channel]:
            if op == "Voice" or op == "Regular":
                continue
            if user in irc.get_channel_info()[channel][op]:
                is_channel_admin = True
                break

        if is_channel_admin:
            for templateNum in range(len(IRC_TOPIC_TEMPLATES)):
                irc.send_private_message(user_mask[0], str(templateNum + 1) + '. ' + IRC_TOPIC_TEMPLATES[templateNum])
        else:
            irc.send_private_message(user_mask[0], "5ERROR: You do not have privilages to change the topic in this "
                                                  "channel, therefore you cannot use this command.")
